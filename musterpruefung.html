<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Musterpr√ºfung</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>üìë Musterpr√ºfung</h1>
  </header>
  <main id="app">
    <div id="exam-container">
      <div id="teil1">
        <h2>Teil 1</h2>
        <div id="questions1"></div>
      </div>
      <div id="teil2">
        <h2>Teil 2</h2>
        <div id="questions2"></div>
      </div>
      <button id="submit-btn" class="quiz-btn">Abschlie√üen</button>
      <div id="result"></div>
    </div>
    <button class="zuruck-btn" onclick="history.back()">Zur√ºck</button>
  </main>

  <script>
    let examData;
    fetch('Exams-30-Muster.json')
      .then(res => res.json())
      .then(data => {
        // ÿ±€åŸÜ⁄àŸÖ ÿß€å⁄©ÿ≤€åŸÖ ŸÖŸÜÿ™ÿÆÿ® ⁄©ÿ±€å⁄∫
        const exams = data.exams;
        const selected = exams[Math.floor(Math.random() * exams.length)];
        examData = selected;
        loadTeil(selected.teil_1, 'questions1');
        loadTeil(selected.teil_2, 'questions2');
      })
      .catch(err => console.error(err));

    function loadTeil(questions, containerId) {
      const container = document.getElementById(containerId);
      questions.forEach((q, idx) => {
        const qEl = document.createElement('div');
        qEl.className = 'question';
        qEl.textContent = (idx+1) + ". " + q.frage;
        container.appendChild(qEl);
        const optionsList = document.createElement('ul');
        optionsList.className = 'options';
        q.antworten.forEach(ans => {
          const li = document.createElement('li');
          const btn = document.createElement('button');
          btn.className = 'option-button';
          btn.textContent = ans;
          btn.onclick = () => {
            // ÿß€å⁄© ÿ¨Ÿàÿßÿ® ŸÖŸÜÿ™ÿÆÿ® ⁄©ÿ±ŸÜ€í Ÿæÿ± ÿ®ŸπŸÜ ⁄©ÿßŸÑÿ±
            q.selected = ans;
            Array.from(optionsList.children).forEach(l => l.firstChild.classList.remove('selected'));
            btn.classList.add('selected');
          };
          li.appendChild(btn);
          optionsList.appendChild(li);
        });
        container.appendChild(optionsList);
      });
    }

    document.getElementById('submit-btn').addEventListener('click', () => {
      let total = 0, correctCount = 0;
      ['questions1', 'questions2'].forEach(id => {
        const div = document.getElementById(id);
        Array.from(div.children).forEach((qEl, i) => {
          if (qEl.tagName === 'DIV') {
            const ansBtns = qEl.nextSibling;
            const selectedBtn = Array.from(ansBtns.children).find(li => li.firstChild.classList.contains('selected'));
            const selected = selectedBtn ? selectedBtn.firstChild.textContent : null;
            const correct = (id === 'questions1' ? examData.teil_1[i] : examData.teil_2[i]).richtigeAntwort;
            if (selected === correct) {
              correctCount++;
            }
            total++;
          }
        });
      });
      const score = Math.round((correctCount / total) * 100);
      document.getElementById('result').innerHTML = 
        `<h3>Ergebnis: ${correctCount} von ${total} richtig (${score}%)</h3>`;
    });
  </script>
</body>
</html>
